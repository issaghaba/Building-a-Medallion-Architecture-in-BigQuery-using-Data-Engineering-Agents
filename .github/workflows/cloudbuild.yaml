steps:
  # Step 1: Install dependencies
  - name: 'node:18'
    entrypoint: 'bash'
    args:
      - -c
      - |
        npm ci || npm install

  # Step 2: Run Dataform compilation check (syntax + dependency validation)
  - name: 'node:18'
    entrypoint: 'bash'
    args:
      - -c
      - |
        npx dataform compile

  # Step 3: Run Dataform assertions (data quality tests)
  - name: 'node:18'
    entrypoint: 'bash'
    args:
      - -c
      - |
        npx dataform run --tags assertions
